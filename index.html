<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clicker Master - Modo Cooperativo</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      user-select: none;
    }

    .game-container {
      width: 90%;
      max-width: 1000px;
      margin: 20px auto;
      text-align: center;
    }

    .progress-container {
      width: 100%;
      height: 30px;
      background-color: #e0e0e0;
      border-radius: 15px;
      margin: 20px 0;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background-color: #4CAF50;
      width: 0%;
      transition: width 0.2s;
      border-radius: 15px;
    }

    .stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .stat-box {
      background-color: #fff;
      padding: 10px 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      flex: 1;
      min-width: 100px;
      margin: 5px;
    }

    .click-areas {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .click-area {
      flex: 1;
      height: 200px;
      background-color: #fff;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: transform 0.1s;
      position: relative;
      overflow: hidden;
    }

    .click-area:active {
      transform: scale(0.98);
      background-color: #f8f8f8;
    }

    .player-identifier {
      position: absolute;
      top: 10px;
      left: 10px;
      padding: 5px 10px;
      border-radius: 5px;
      font-weight: bold;
      color: white;
    }

    .player1 .player-identifier {
      background-color: #2196F3;
    }

    .player2 .player-identifier {
      background-color: #FF5722;
    }

    .click-effect {
      position: absolute;
      pointer-events: none;
      border-radius: 50%;
      animation: clickEffect 0.5s forwards;
      opacity: 0.6;
    }

    @keyframes clickEffect {
      0% {
        transform: scale(0);
        opacity: 0.7;
      }
      100% {
        transform: scale(1);
        opacity: 0;
      }
    }

    h1 {
      color: #333;
    }

    .level-up {
      animation: pulse 1s;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .game-sections {
      display: flex;
      gap: 20px;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .section {
      flex: 1;
      min-width: 300px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      padding: 15px;
      margin-bottom: 20px;
    }

    .upgrade-item, .achievement-item {
      background-color: #f9f9f9;
      border-radius: 8px;
      padding: 10px;
      margin: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.2s;
    }

    .upgrade-item:hover {
      background-color: #f0f0f0;
    }

    .upgrade-item.disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    .buy-button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .buy-button:hover {
      background-color: #45a049;
    }

    .buy-button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }

    .achievement-item.unlocked {
      background-color: #e7f7e7;
      border-left: 4px solid #4CAF50;
    }

    .achievement-item.locked {
      background-color: #f0f0f0;
      border-left: 4px solid #cccccc;
      color: #777;
    }

    .upgrade-info, .achievement-info {
      text-align: left;
    }
    
    .upgrade-level {
      font-size: 0.8em;
      color: #666;
    }
    
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #4CAF50;
      color: white;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 100;
    }
    
    .notification.show {
      opacity: 1;
    }

    .player-stats {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .player-stat {
      flex: 1;
      background-color: #fff;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .player-stat.player1 {
      border-top: 5px solid #2196F3;
    }

    .player-stat.player2 {
      border-top: 5px solid #FF5722;
    }

    .player-stat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .player-stat-content {
      display: flex;
      gap: 10px;
    }

    .player-stat-item {
      flex: 1;
      text-align: center;
      background-color: #f9f9f9;
      padding: 10px;
      border-radius: 5px;
    }

    .player-stat-label {
      font-size: 0.8em;
      color: #666;
    }

    .player-stat-value {
      font-size: 1.2em;
      font-weight: bold;
    }

    .player-contribution {
      height: 5px;
      background-color: #e0e0e0;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 10px;
    }

    .player1-contribution {
      height: 100%;
      background-color: #2196F3;
      float: left;
    }

    .player2-contribution {
      height: 100%;
      background-color: #FF5722;
      float: right;
    }

    .mode-selection {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 10px 0;
    }

    .mode-button {
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s;
    }

    .mode-button.active {
      background-color: #4CAF50;
      color: white;
    }

    .mode-button:not(.active) {
      background-color: #e0e0e0;
      color: #333;
    }

    .tab-buttons {
      display: flex;
      margin-bottom: 15px;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      background-color: #e0e0e0;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s;
    }

    .tab-button:first-child {
      border-top-left-radius: 5px;
      border-bottom-left-radius: 5px;
    }

    .tab-button:last-child {
      border-top-right-radius: 5px;
      border-bottom-right-radius: 5px;
    }

    .tab-button.active {
      background-color: #4CAF50;
      color: white;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .synergy-upgrade {
      background-color: #e3f2fd;
      border-left: 4px solid #2196F3;
    }

    /* Media Queries for responsive design */
    @media (max-width: 768px) {
      .click-areas {
        flex-direction: column;
      }
      
      .player-stats {
        flex-direction: column;
      }
    }

    .team-bonus {
      background-color: #e8f5e9;
      border-radius: 5px;
      padding: 10px;
      margin: 10px 0;
      text-align: center;
      font-weight: bold;
      border: 1px dashed #4CAF50;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>Clicker Master</h1>

    <div class="mode-selection">
      <button class="mode-button" id="solo-mode-button">Modo Solo</button>
      <button class="mode-button active" id="coop-mode-button">Modo Cooperativo</button>
    </div>
    
    <div class="stats">
      <div class="stat-box">
        <h3>Nível</h3>
        <div id="level">1</div>
      </div>
      <div class="stat-box">
        <h3>Cliques</h3>
        <div id="clicks">0</div>
      </div>
      <div class="stat-box">
        <h3>Meta</h3>
        <div id="target">20</div>
      </div>
      <div class="stat-box">
        <h3>Moedas</h3>
        <div id="coins">0</div>
      </div>
      <div class="stat-box">
        <h3>Poder de Clique</h3>
        <div id="click-power">1</div>
      </div>
    </div>
    
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>

    <div class="team-bonus" id="team-bonus">
      Bônus de Equipe: +20% de poder de clique quando ambos jogadores estão ativos!
    </div>
    
    <div class="player-stats">
      <div class="player-stat player1">
        <div class="player-stat-header">
          <h3>Jogador 1</h3>
          <div>Cliques: <span id="player1-clicks">0</span></div>
        </div>
        <div class="player-stat-content">
          <div class="player-stat-item">
            <div class="player-stat-label">Poder</div>
            <div class="player-stat-value" id="player1-power">1</div>
          </div>
          <div class="player-stat-item">
            <div class="player-stat-label">Contribuição</div>
            <div class="player-stat-value" id="player1-contribution">0%</div>
          </div>
        </div>
      </div>
      
      <div class="player-stat player2">
        <div class="player-stat-header">
          <h3>Jogador 2</h3>
          <div>Cliques: <span id="player2-clicks">0</span></div>
        </div>
        <div class="player-stat-content">
          <div class="player-stat-item">
            <div class="player-stat-label">Poder</div>
            <div class="player-stat-value" id="player2-power">1</div>
          </div>
          <div class="player-stat-item">
            <div class="player-stat-label">Contribuição</div>
            <div class="player-stat-value" id="player2-contribution">0%</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="player-contribution">
      <div class="player1-contribution" id="player1-contribution-bar" style="width: 50%"></div>
      <div class="player2-contribution" id="player2-contribution-bar" style="width: 50%"></div>
    </div>
    
    <div class="click-areas">
      <div class="click-area player1" id="player1-area">
        <div class="player-identifier">Jogador 1 (Q)</div>
        Clique aqui ou pressione Q!
      </div>
      
      <div class="click-area player2" id="player2-area">
        <div class="player-identifier">Jogador 2 (P)</div>
        Clique aqui ou pressione P!
      </div>
    </div>
    
    <div class="game-sections">
      <div class="section">
        <div class="tab-buttons">
          <button class="tab-button active" data-tab="upgrades">Upgrades</button>
          <button class="tab-button" data-tab="achievements">Objetivos</button>
        </div>
        
        <div class="tab-content active" id="upgrades">
          <div id="upgrades-container">
            <!-- Upgrades will be added here dynamically -->
          </div>
        </div>
        
        <div class="tab-content" id="achievements">
          <div id="achievements-container">
            <!-- Achievements will be added here dynamically -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="notification" id="notification"></div>

  <script>
    // Game state
    let clicks = 0;
    let level = 1;
    let targetClicks = 20; // Increased for cooperative mode
    let coins = 0;
    let clickPower = 1;
    let isCoopMode = true;
    
    // Player stats
    const players = {
      player1: {
        clicks: 0,
        power: 1,
        key: 'Q',
        keyCode: 81,
        lastClickTime: 0,
        isActive: false
      },
      player2: {
        clicks: 0,
        power: 1,
        key: 'P',
        keyCode: 80,
        lastClickTime: 0,
        isActive: false
      }
    };
    
    // DOM elements
    const progressBar = document.getElementById('progress-bar');
    const clicksDisplay = document.getElementById('clicks');
    const levelDisplay = document.getElementById('level');
    const targetDisplay = document.getElementById('target');
    const coinsDisplay = document.getElementById('coins');
    const clickPowerDisplay = document.getElementById('click-power');
    const player1Area = document.getElementById('player1-area');
    const player2Area = document.getElementById('player2-area');
    const player1Clicks = document.getElementById('player1-clicks');
    const player2Clicks = document.getElementById('player2-clicks');
    const player1Power = document.getElementById('player1-power');
    const player2Power = document.getElementById('player2-power');
    const player1Contribution = document.getElementById('player1-contribution');
    const player2Contribution = document.getElementById('player2-contribution');
    const player1ContributionBar = document.getElementById('player1-contribution-bar');
    const player2ContributionBar = document.getElementById('player2-contribution-bar');
    const teamBonus = document.getElementById('team-bonus');
    const gameContainer = document.querySelector('.game-container');
    const upgradesContainer = document.getElementById('upgrades-container');
    const achievementsContainer = document.getElementById('achievements-container');
    const notification = document.getElementById('notification');
    const soloModeButton = document.getElementById('solo-mode-button');
    const coopModeButton = document.getElementById('coop-mode-button');
    const playerStats = document.querySelector('.player-stats');
    const clickAreas = document.querySelector('.click-areas');
    
    // Upgrades definition
    const upgrades = [
      {
        id: 'click-power',
        name: 'Poder de Clique',
        description: 'Aumenta o valor de cada clique',
        basePrice: 10,
        level: 0,
        maxLevel: 10,
        effect: level => level + 1,
        priceIncrease: 1.5,
        forPlayer: null // Affects both players
      },
      {
        id: 'auto-clicker',
        name: 'Auto Clicker',
        description: 'Clica automaticamente a cada segundo',
        basePrice: 50,
        level: 0,
        maxLevel: 5,
        effect: level => level,
        priceIncrease: 2,
        forPlayer: null // Affects both players
      },
      {
        id: 'coin-boost',
        name: 'Boost de Moedas',
        description: 'Aumenta as moedas ganhas por nível',
        basePrice: 30,
        level: 0,
        maxLevel: 5,
        effect: level => 1 + level * 0.2, // 20% increase per level
        priceIncrease: 1.8,
        forPlayer: null // Affects both players
      },
      {
        id: 'progress-boost',
        name: 'Boost de Progresso',
        description: 'Reduz o aumento da dificuldade entre níveis',
        basePrice: 100,
        level: 0,
        maxLevel: 3,
        effect: level => 1.25 - (level * 0.05), // Reduces from 1.25 to 1.10
        priceIncrease: 2.5,
        forPlayer: null // Affects both players
      },
      {
        id: 'player1-power',
        name: 'Poder Jogador 1',
        description: 'Aumenta o poder de clique do Jogador 1',
        basePrice: 15,
        level: 0,
        maxLevel: 5,
        effect: level => level + 1,
        priceIncrease: 1.6,
        forPlayer: 'player1',
        coop: true // Only available in coop mode
      },
      {
        id: 'player2-power',
        name: 'Poder Jogador 2',
        description: 'Aumenta o poder de clique do Jogador 2',
        basePrice: 15,
        level: 0,
        maxLevel: 5,
        effect: level => level + 1,
        priceIncrease: 1.6,
        forPlayer: 'player2',
        coop: true // Only available in coop mode
      },
      {
        id: 'synergy-boost',
        name: 'Sinergia de Equipe',
        description: 'Aumenta o bônus quando ambos jogadores estão ativos',
        basePrice: 75,
        level: 0,
        maxLevel: 3,
        effect: level => 0.2 + (level * 0.1), // Increases team bonus from 20% to 50%
        priceIncrease: 2,
        forPlayer: null,
        coop: true, // Only available in coop mode
        synergy: true // Special synergy upgrade
      }
    ];
    
    // Achievements definition
    const achievements = [
      {
        id: 'first-level',
        name: 'Primeiro Nível',
        description: 'Complete o nível 1',
        unlocked: false,
        requirement: () => level > 1,
        reward: 5
      },
      {
        id: 'level-5',
        name: 'Persistente',
        description: 'Alcance o nível 5',
        unlocked: false,
        requirement: () => level >= 5,
        reward: 20
      },
      {
        id: 'level-10',
        name: 'Dedicado',
        description: 'Alcance o nível 10',
        unlocked: false,
        requirement: () => level >= 10,
        reward: 50
      },
      {
        id: 'level-25',
        name: 'Mestre Clicker',
        description: 'Alcance o nível 25',
        unlocked: false,
        requirement: () => level >= 25,
        reward: 150
      },
      {
        id: 'coins-100',
        name: 'Colecionador',
        description: 'Acumule 100 moedas',
        unlocked: false,
        requirement: () => coins >= 100,
        reward: 10
      },
      {
        id: 'upgrade-max',
        name: 'Aprimorado',
        description: 'Maximize um upgrade',
        unlocked: false,
        requirement: () => upgrades.some(upgrade => upgrade.level >= upgrade.maxLevel),
        reward: 75
      },
      {
        id: 'team-balance',
        name: 'Equilíbrio de Equipe',
        description: 'Tenha contribuição balanceada entre jogadores (45-55%)',
        unlocked: false,
        requirement: () => {
          const total = players.player1.clicks + players.player2.clicks;
          if (total === 0) return false;
          const p1Percent = (players.player1.clicks / total) * 100;
          return p1Percent >= 45 && p1Percent <= 55;
        },
        reward: 30,
        coop: true
      },
      {
        id: 'team-synergy',
        name: 'Sinergia Perfeita',
        description: 'Complete um nível com ambos jogadores contribuindo',
        unlocked: false,
        requirement: () => players.player1.isActive && players.player2.isActive,
        reward: 40,
        coop: true
      }
    ];
    
    // Initialize game
    function initGame() {
      updateDisplays();
      renderUpgrades();
      renderAchievements();
      updateModeDisplay();
      
      // Add click events for click areas
      player1Area.addEventListener('click', (e) => {
        e.stopPropagation();
        playerClick('player1', e);
      });
      
      player2Area.addEventListener('click', (e) => {
        e.stopPropagation();
        playerClick('player2', e);
      });
      
      // Add keyboard controls
      document.addEventListener('keydown', (e) => {
        if (e.keyCode === players.player1.keyCode) {
          playerClick('player1');
        } else if (e.keyCode === players.player2.keyCode) {
          playerClick('player2');
        }
      });
      
      // Mode selection buttons
      soloModeButton.addEventListener('click', () => {
        isCoopMode = false;
        updateModeDisplay();
      });
      
      coopModeButton.addEventListener('click', () => {
        isCoopMode = true;
        updateModeDisplay();
      });
      
      // Tab switching
      document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', () => {
          // Remove active class from all buttons and tabs
          document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
          
          // Add active class to clicked button and corresponding tab
          button.classList.add('active');
          document.getElementById(button.dataset.tab).classList.add('active');
        });
      });
      
      // Start auto-clicker timer
      setInterval(runAutoClicker, 1000);
      
      // Start achievement check timer
      setInterval(checkAchievements, 2000);
      
      // Check player activity timer
      setInterval(checkPlayerActivity, 5000);
    }
    
    // Player click handler
    function playerClick(playerKey, event) {
      if (!isCoopMode && playerKey === 'player2') return; // In solo mode, only player 1 can click
      
      const player = players[playerKey];
      player.lastClickTime = Date.now();
      player.isActive = true;
      
      // Apply power
      const clickValue = player.power;
      player.clicks += clickValue;
      clicks += clickValue;
      
      // Apply team bonus if both players are active
      if (isCoopMode && players.player1.isActive && players.player2.isActive) {
        const synergyBoost = getUpgradeEffect('synergy-boost');
        const teamBonus = clickValue * synergyBoost;
        clicks += teamBonus;
      }
      
      // Create click effect animation if event exists
      if (event) {
        createClickEffect(event, playerKey);
      } else {
        // For keyboard clicks, create effect in the center of the corresponding area
        const area = document.getElementById(`${playerKey}-area`);
        const rect = area.getBoundingClientRect();
        const dummyEvent = {
          clientX: rect.left + rect.width / 2,
          clientY: rect.top + rect.height / 2,
          target: area
        };
        createClickEffect(dummyEvent, playerKey);
      }
      
      updateProgressBar();
      updatePlayerContributions();
      updateDisplays();
      
      // Check if target reached
      if (clicks >= targetClicks) {
        levelUp();
      }
    }
    
    // Create click effect animation
    function createClickEffect(event, playerKey) {
      const effect = document.createElement('div');
      effect.classList.add('click-effect');
      
      // Position effect at click coordinates relative to target
      const rect = event.target.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      
      effect.style.left = `${x}px`;
      effect.style.top = `${y}px`;
      effect.style.width = '50px';
      effect.style.height = '50px';
      
      // Set color based on player
      if (playerKey === 'player1') {
        effect.style.backgroundColor = '#2196F3';
      } else {
        effect.style.backgroundColor = '#FF5722';
      }
      
      event.target.appendChild(effect);
      
      // Remove effect after animation
      setTimeout(() => {
        effect.remove();
      }, 500);
    }
    
    // Update progress bar
    function updateProgressBar() {
      const progress = (clicks / targetClicks) * 100;
      progressBar.style.width = `${Math.min(100, progress)}%`;
    }
    
    // Update player contributions
    function updatePlayerContributions() {
      const totalClicks = players.player1.clicks + players.player2.clicks;
      if (totalClicks === 0) return;
      
      const p1Percent = Math.round((players.player1.clicks / totalClicks) * 100);
      const p2Percent = 100 - p1Percent;
      
      player1Contribution.textContent = p1Percent + '%';
      player2Contribution.textContent = p2Percent + '%';
      
      player1ContributionBar.style.width = p1Percent + '%';
      player2ContributionBar.style.width = p2Percent + '%';
    }
    
    // Update display elements
    function updateDisplays() {
      clicksDisplay.textContent = Math.floor(clicks);
      levelDisplay.textContent = level;
      targetDisplay.textContent = Math.ceil(targetClicks);
      coinsDisplay.textContent = Math.floor(coins);
      clickPowerDisplay.textContent = clickPower;
      
      player1Clicks.textContent = Math.floor(players.player1.clicks);
      player2Clicks.textContent = Math.floor(players.player2.clicks);
      player1Power.textContent = players.player1.power;
      player2Power.textContent = players.player2.power;
      
      // Update the team bonus text
      if (isCoopMode) {
        const synergyBoost = getUpgradeEffect('synergy-boost');
        teamBonus.textContent = `Bônus de Equipe: +${Math.round(synergyBoost * 100)}% de poder quando ambos jogadores estão ativos!`;
      }
    }
    
    // Update mode display
    function updateModeDisplay() {
      if (isCoopMode) {
        soloModeButton.classList.remove('active');
        coopModeButton.classList.add('active');
        clickAreas.style.display = 'flex';
        playerStats.style.display = 'flex';
        teamBonus.style.display = 'block';
        player2Area.style.display = 'flex';
        targetClicks = 20; // More clicks required for coop mode
      } else {
        soloModeButton.classList.add('active');
        coopModeButton.classList.remove('active');
        // In solo mode, we still show both areas but disable player 2
        clickAreas.style.display = 'flex';
        playerStats.style.display = 'flex';
        teamBonus.style.display = 'none';
        player2Area.style.display = 'none';
        targetClicks = 10; // Fewer clicks required for solo mode
      }
      
      updateDisplays();
      renderUpgrades(); // Re-render with mode-specific upgrades
      renderAchievements(); // Re-render with mode-specific achievements
